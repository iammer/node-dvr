#!/usr/bin/env node

var net=require('net');

var dvr=net.createConnection({host: '10.0.0.21', port: '9000'});

dvr.on('connect',function() {
	var bytes=0;
	dvr.on('data',function(d) {
		if (bytes<16) {
			bytes+=d.length;
		} else {
			if (d[4]==0x48) {
				process.stdout.write(d.slice(0,4));
				process.stdout.write(d.slice(8,12));
				process.stdout.write(d.slice(30));
			}
		}
	});
	
	var getStream=new Buffer(
	'00000000000000000000010000000303' + 
	'00000000000000000000680000000100' +
	'00001000000001000000010000000061' +
	'646d696e000000094060210000000022' +
	'01000000000000094f512100000e0100' +
	'02917c0400000048070e0100000e0188' +
	'1135016cf5120000000000b0f7120000' + 
	'00000000000000000000000000000000' +
	'00000000000000000000000000000000' +
	'00000000000000000000000000000000' +
	'00000000000000000000000000000000' +
	'00000000000000000000000000000000' +
	'00000000000000000000000000000000' +
	'00000000000000000000000000000000' +
	'00000000000000000000000000000000' +
	'00000000000000000000000000000000' +
	'00000000000000000000000000000000' +
	'00000000000000000000000000000000' +
	'00000000000000000000000000000000' +
	'00000000000000000000000000000000' +
	'00000000000000000000000000000000' +
	'00000000000000000000000000000000' +
	'00000000000000000000000000000000' +
	'00000000000000000000000000000000' +
	'00000000000000000000000000000000' +
	'00000000000000000000000000000000' +
	'00000000000000000000000000000000' +
	'00000000000000000000000000000000' +
	'00000000000000000000000000000000' +
	'00000000000000000000000000000000' +
	'00000000000000000000000000000000' +
	'0000000000000000000000','hex');
	
	dvr.write(getStream);
});



